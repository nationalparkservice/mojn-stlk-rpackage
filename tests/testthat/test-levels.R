context("Levels")

dummy.levels <- tibble::tibble(Park = c("PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK"),
                               SiteShort = c("FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0"),
                               SiteCode = c("PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_TEST2", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0"),
                               SiteName = c("First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake"),
                               VisitDate = as.Date(c("9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/26/2019", "9/26/2019", "9/26/2019", "9/26/2019", "9/26/2019", "9/26/2019", "9/26/2019", "9/26/2019", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016"), "%m/%d/%y"),
                               FieldSeason = c(2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016),
                               VisitType = c("Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary"),
                               DPL = c("Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted"),
                               Instrument = c("DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-1000", "DL-1001", "DL-1002", "DL-1003", "DL-1004", "DL-1005", "DL-1006", "DL-1007", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999", "DL-999"),
                               RodMaterial = c("Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib", "Fib"),
                               CTE = c(0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002),
                               InstrumentOperator = c("ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF"),
                               RodOperator = c("DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "DEF", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "UNK", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI", "GHI"),
                               AdditionalCrew = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
                               NumberOfInstrumentSetups = c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2),
                               RodTemperatureSetup1_F = c(73, 73, 73, 73, 73, 73, 73, 73, 73, 73, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 68, 68, 68, 68, 68, 68, 68, 68, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52),
                               RodTemperatureSetup2_F = c(78, 78, 78, 78, 78, 78, 78, 78, 78, 78, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 70, 70, 70, 70, 70, 70, 70, 70, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63),
                               RodTemperatureSetup3_F = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
                               NumberOfBenchmarksUsed = c(3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4),
                               RM1_GivenElevation_m = c(100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.3048, 100.3048, 100.3048, 100.3048, 100.3048, 100.3048, 100.3048, 100.3048, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000, 101.5000),
                               RM1 = c("FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM1", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3", "SCND0-BM3"),
                               RM2 = c("FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM2", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4", "SCND0-BM4"),
                               RM3 = c("FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", "FRST0-BM3", NA, NA, NA, NA, NA, NA, NA, NA, "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5", "SCND0-BM5"),
                               RM4 = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6", "SCND0-BM6"),
                               RM5 = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
                               RM6 = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
                               SurveyPointType = c("RM1-BS-S1", "RM2-FS-S1", "RM3-FS-S1", "WS-FS-S1", "TP1-FS-S1", "TP1-BS-S2", "WS-FS-S2", "RM3-FS-S2", "RM2-FS-S2", "RM1-FS-S2", "RM1-BS-S1", "RM2-FS-S1", "RM3-FS-S1", "WS-FS-S1", "TP1-FS-S1", "TP1-BS-S2", "WS-FS-S2", "RM3-FS-S2", "RM2-FS-S2", "RM1-FS-S2", "RM1-BS-S1", "RM2-FS-S1", "RM3-FS-S1", "WS-FS-S1", "TP1-FS-S1", "TP1-BS-S2", "WS-FS-S2", "RM3-FS-S2", "RM2-FS-S2", "RM1-FS-S2", "RM1-BS-S1", "RM2-FS-S1", "WS-FS-S1", "TP1-FS-S1", "TP1-BS-S2", "WS-FS-S2", "RM2-FS-S2", "RM1-FS-S2", "RM1-BS-S1", "RM2-FS-S1", "RM3-FS-S1", "RM4-FS-S2", "WS-FS-S1", "TP1-FS-S1", "TP1-BS-S2", "WS-FS-S2", "RM4-FS-S2", "RM3-FS-S2", "RM2-FS-S2", "RM1-FS-S2"),
                               Height_ft = c(4.000, 3.000, 2.000, 5.000, 2.500, 2.800, 5.301, 2.300, 3.298, 4.300, 4.000, 3.002, 2.001, 4.664, 2.200, 2.150, 4.611, 1.951, 2.950, 3.950, 5.000, 4.000, 3.000, 7.111, 2.500, 2.600, 7.217, 3.101, 4.102, 5.103, 4.000, 3.000, 4.350, 3.500, 3.800, 4.652, 3.297, 4.300, 16.000, 5.000, 2.000, 1.000, 16.405, 2.780, 2.806, 16.445, 1.026, 2.025, 5.026, 16.020))

dir <- "temp-test-csv"
dir.create(dir)
readr::write_csv(dummy.levels, file.path(dir, "Levels.csv"), na = "")

test_that("SurveyPointElevation works as expected", {
  expected <- tibble::tibble(Park = c("PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK", "PARK"),
                             SiteShort = c("FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "FRST0", "SCND0", "SCND0", "SCND0", "SCND0", "SCND0"),
                             SiteCode = c("PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_FRST0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0", "PARK_L_SCND0"),
                             SiteName = c("First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "First Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake", "Second Lake"),
                             VisitDate = as.Date(c("9/28/2016", "9/28/2016", "9/28/2016", "9/28/2016", "9/25/2017", "9/25/2017", "9/25/2017", "9/25/2017", "9/27/2018", "9/27/2018", "9/27/2018", "9/27/2018", "9/26/2019", "9/26/2019", "9/26/2019", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016", "9/29/2016"), "%m/%d/%y"),
                             FieldSeason = c(2016, 2016, 2016, 2016, 2017, 2017, 2017, 2017, 2018, 2018, 2018, 2018, 2019, 2019, 2019, 2016, 2016, 2016, 2016, 2016),
                             VisitType = c("Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary"),
                             DPL = c("Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Raw", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted"),
                             SurveyPoint = c("RM1", "RM2", "RM3", "WS", "RM1", "RM2", "RM3", "WS", "RM1", "RM2", "RM3", "WS", "RM1", "RM2", "WS", "RM1", "RM2", "RM3", "RM4", "WS"),
                             Benchmark = c("FRST0-BM1", "FRST0-BM2", "FRST0-BM3", "Water Surface", "FRST0-BM1", "FRST0-BM2", "FRST0-BM3", "Water Surface", "FRST0-BM1", "FRST0-BM2", "FRST0-BM3", "Water Surface", "FRST0-BM2", "FRST0-BM3", "Water Surface", "SCND0-BM3", "SCND0-BM4", "SCND0-BM5", "SCND0-BM6", "Water Surface"),
                             ClosureError_ft = c(0, 0, 0, 0, 0, 0, 0, 0, 0.003, 0.003, 0.003, 0.003, 0, 0, 0, 0.0022, 0.0022, 0.0022, 0.0022, 0.0022),
                             FinalCorrectedElevation_ft = c(328.0800, 329.0810, 330.0800, 327.0795, 328.0800, 329.0790, 330.0790, 327.4175, 328.0800, 329.0813, 330.0818, 325.9683, 329.0800, 330.0815, 328.7290, 333.0012, 343.9957, 346.9957, 347.9950, 332.5855))
  result <- SurveyPointElevation(path.to.data = dir, data.source = "local")
  expect_dataframe_equal(result,expected)
})

# Remove temporary csv files
unlink(dir, recursive = TRUE)
