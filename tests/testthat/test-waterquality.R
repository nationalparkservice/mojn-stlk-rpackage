context ("Waterquality")

dummy.temp <- tibble::tibble(Park = c("DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "MOJA", "MOJA", "MOJA", "JOTR", "JOTR", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA"), 
                             SiteCode = c("DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012"),
                             SiteName = c("Spring 01", "Spring 01", "Spring 01", "Spring 02", "Spring 02", "Spring 02", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 04", "Spring 04", "Spring 04", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 06", "Spring 06", "Spring 06", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 08", "Spring 08", "Spring 08", "Spring 09", "Spring 09", "Spring 09", "Spring 10", "Spring 10", "Spring 10", "Spring 11", "Spring 11", "Spring 11", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12"), 
                             VisitDate = as.Date(c("2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-21", "2018-11-21", "2018-11-21", "2019-11-19", "2019-11-19", "2019-11-19", "2018-11-14", "2018-11-14", "2018-11-14", "2018-11-15", "2018-11-15", "2018-11-15", "2019-11-07", "2019-11-07", "2019-11-07", "2019-04-09", "2019-04-09", "2019-04-09", "2019-04-10", "2019-04-10", "2019-04-10", "2020-04-07", "2020-04-07", "2020-04-07", "2020-03-02", "2020-03-02", "2020-03-02", "2020-01-29", "2020-01-29", "2020-01-29", "2019-02-12", "2019-02-12", "2019-02-12", "2019-02-13", "2019-02-13", "2019-02-13", "2019-02-14", "2019-02-14", "2019-02-14", "2019-02-21", "2019-02-21", "2019-02-21")), 
                             FieldSeason = c("2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019"), 
                             WQDataCollected = c("Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"), 
                             WaterTemperature_C = c(17.1, 17.2, 17.1, 8.90, 8.90, 8.89, 3.11, 3.13, 3.14, 6.23, 6.21, 6.24, 51.3, 51.3, 51.3, 18.4, 18.4, 18.4, 18.7, 18.8, 18.8, 14.6, 14.6, 14.6, 9.43, 9.41, 9.42, 10.8, 10.9, 10.9, 14.2, 14.2, 14.2, 12.1, 12.1, 12.1, 19.4, 19.4, 19.4, 13.8, 13.9, 13.9, 9.75, 9.75, 9.75, 9.81, 9.81, 9.81), 
                             DataQualityFlag = c("NF", "NF", "NF", "NF", "NF", "NF", "I", "I", "I", NA, NA, NA, "I", "I", "I", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, NA, NA, NA), 
                             DataQualityFlagNote = c(NA, NA, NA, NA, NA, NA, "had to break through ice", "had to break through ice", "had to break through ice", NA, NA, NA, "hot spring near river", "hot spring near river", "hot spring near river", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), 
                             TempInstrument = c("YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1"), 
                             VisitType = c("Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Replicate", "Replicate", "Replicate"), 
                             DPL = c("Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional"), 
                             MonitoringStatus = c("Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled"))

dummy.spcond <- tibble::tibble(Park = c("DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "MOJA", "MOJA", "MOJA", "JOTR", "JOTR", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA"), 
                               SiteCode = c("DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012"),
                               SiteName = c("Spring 01", "Spring 01", "Spring 01", "Spring 02", "Spring 02", "Spring 02", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 04", "Spring 04", "Spring 04", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 06", "Spring 06", "Spring 06", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 08", "Spring 08", "Spring 08", "Spring 09", "Spring 09", "Spring 09", "Spring 10", "Spring 10", "Spring 10", "Spring 11", "Spring 11", "Spring 11", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12"), 
                               VisitDate = as.Date(c("2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-21", "2018-11-21", "2018-11-21", "2019-11-19", "2019-11-19", "2019-11-19", "2018-11-14", "2018-11-14", "2018-11-14", "2018-11-15", "2018-11-15", "2018-11-15", "2019-11-07", "2019-11-07", "2019-11-07", "2019-04-09", "2019-04-09", "2019-04-09", "2019-04-10", "2019-04-10", "2019-04-10", "2020-04-07", "2020-04-07", "2020-04-07", "2020-03-02", "2020-03-02", "2020-03-02", "2020-01-29", "2020-01-29", "2020-01-29", "2019-02-12", "2019-02-12", "2019-02-12", "2019-02-13", "2019-02-13", "2019-02-13", "2019-02-14", "2019-02-14", "2019-02-14", "2019-02-21", "2019-02-21", "2019-02-21")), 
                               FieldSeason = c("2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019"), 
                               WQDataCollected = c("Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"), 
                               SpecificConductance_microS_per_cm = c(2340, 2345, 2342, 3863, 3865, 3863, NA, NA, NA, 976, 977, 976, 876, 876, 877, 3233, 3234, 3230, 3314, 3312, 3312, 1801, 1799, 1802, 320, 320, 320, 346, 346, 347, 51102, 51114, 51097, 780, 782, 782, 1320, 1320, 1320, 8643, 8641, 8644, 2678, 2676, 2676, 2628, 2629, 2628), 
                               DataQualityFlag = c("NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", "NF", "NF", "NF", "I", "I", "I", "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, NA, NA, NA), 
                               DataQualityFlagNote = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "spring on salty playa", "spring on salty playa", "spring on salty playa", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), 
                               SpCondInstrument = c("YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1"), 
                               VisitType = c("Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Replicate", "Replicate", "Replicate"), 
                               DPL = c("Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional"), 
                               MonitoringStatus = c("Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled"))

dummy.ph <- tibble::tibble(Park = c("DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "MOJA", "MOJA", "MOJA", "JOTR", "JOTR", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA"), 
                           SiteCode = c("DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012"),
                           SiteName = c("Spring 01", "Spring 01", "Spring 01", "Spring 02", "Spring 02", "Spring 02", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 04", "Spring 04", "Spring 04", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 06", "Spring 06", "Spring 06", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 08", "Spring 08", "Spring 08", "Spring 09", "Spring 09", "Spring 09", "Spring 10", "Spring 10", "Spring 10", "Spring 11", "Spring 11", "Spring 11", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12"), 
                           VisitDate = as.Date(c("2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-21", "2018-11-21", "2018-11-21", "2019-11-19", "2019-11-19", "2019-11-19", "2018-11-14", "2018-11-14", "2018-11-14", "2018-11-15", "2018-11-15", "2018-11-15", "2019-11-07", "2019-11-07", "2019-11-07", "2019-04-09", "2019-04-09", "2019-04-09", "2019-04-10", "2019-04-10", "2019-04-10", "2020-04-07", "2020-04-07", "2020-04-07", "2020-03-02", "2020-03-02", "2020-03-02", "2020-01-29", "2020-01-29", "2020-01-29", "2019-02-12", "2019-02-12", "2019-02-12", "2019-02-13", "2019-02-13", "2019-02-13", "2019-02-14", "2019-02-14", "2019-02-14", "2019-02-21", "2019-02-21", "2019-02-21")), 
                           FieldSeason = c("2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019"), 
                           WQDataCollected = c("Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"), 
                           pH = c(7.91, 7.90, 7.89, 3.85, 3.86, 3.86, 7.35, 7.35, 7.34, 7.42, 7.42, 7.42, 7.06, 7.06, 7.06, 7.65, 7.66, 7.65, 7.71, 7.71, 7.72, 10.81, 10.78, 10.85, 7.24, 7.24, 7.24, 7.34, 7.33, 7.32, 7.10, 7.11, 7.10, 6.89, 6.90, 6.89, 8.18, 8.17, 8.18, 5.83, 5.80, 5.76, 7.96, 7.96, 7.95, 7.92, 7.92, 7.92), 
                           DataQualityFlag = c("NF", "NF", "NF", "I", "I", "I", "I", "I", "I", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", NA, NA, NA, "W", "W", "W", NA, NA, NA, NA, NA, NA), 
                           DataQualityFlagNote = c(NA, NA, NA, "spring near mine tailings", "spring near mine tailings", "spring near mine tailings", "had to break through ice", "had to break through ice", "had to break through ice", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "error during pH calibration, probe did not stabilize, might be old", "error during pH calibration, probe did not stabilize, might be old", "error during pH calibration, probe did not stabilize, might be old", NA, NA, NA, NA, NA, NA), 
                           pHInstrument = c("YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1"), 
                           VisitType = c("Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Replicate", "Replicate", "Replicate"), 
                           DPL = c("Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional"), 
                           MonitoringStatus = c("Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled"))

dummy.do <- tibble::tibble(Park = c("DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "PARA", "MOJA", "MOJA", "MOJA", "JOTR", "JOTR", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA"), 
                           SiteCode = c("DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR004", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "LAKE_P_SPR005", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012", "DEVA_P_SPR0012"),
                           SiteName = c("Spring 01", "Spring 01", "Spring 01", "Spring 02", "Spring 02", "Spring 02", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 03", "Spring 04", "Spring 04", "Spring 04", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 05", "Spring 06", "Spring 06", "Spring 06", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 07", "Spring 08", "Spring 08", "Spring 08", "Spring 09", "Spring 09", "Spring 09", "Spring 10", "Spring 10", "Spring 10", "Spring 11", "Spring 11", "Spring 11", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12", "Spring 12"), 
                           VisitDate = as.Date(c("2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-20", "2018-11-21", "2018-11-21", "2018-11-21", "2019-11-19", "2019-11-19", "2019-11-19", "2018-11-14", "2018-11-14", "2018-11-14", "2018-11-15", "2018-11-15", "2018-11-15", "2019-11-07", "2019-11-07", "2019-11-07", "2019-04-09", "2019-04-09", "2019-04-09", "2019-04-10", "2019-04-10", "2019-04-10", "2020-04-07", "2020-04-07", "2020-04-07", "2020-03-02", "2020-03-02", "2020-03-02", "2020-01-29", "2020-01-29", "2020-01-29", "2019-02-12", "2019-02-12", "2019-02-12", "2019-02-13", "2019-02-13", "2019-02-13", "2019-02-14", "2019-02-14", "2019-02-14", "2019-02-21", "2019-02-21", "2019-02-21")), 
                           FieldSeason = c("2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019", "2019"), 
                           WQDataCollected = c("Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"), 
                           DissolvedOxygen_percent = c(84.5, 84.3, 84.3, 140, 139, 137, NA, NA, NA, 88.9, 88.8, 88.7, 42.1, 42.0, 42.1, 172.4, 172.9, 171.8, 78.9, 78.9, 78.8, 90.7, 90.8, 90.6, 84.2, 84.4, 84.4, 82.5, 82.5, 82.5, 72.3, 72.2, 72.2, 29.4, 29.3, 29.2, 69.7, 69.7, 69.6, 85.6, 85.6, 85.6, 91.4, 91.3, 91.2, 90.1, 90.0, 90.0), 
                           DissolvedOxygen_mg_per_L = c(5.76, 5.75, 5.75, 15.56, 15.55, 15.53, NA, NA, NA, 6.76, 6.76, 6.75, 2.34, 2.33, 2.33, 18.43, 18.50, 18.34, 5.05, 5.05, 5.05, 6.84, 6.84, 6.83, 5.45, 5.46, 5.46, 5.31, 5.30, 5.30, 4.96, 4.96, 4.96, 1.97, 1.96, 1.96, 4.70, 4.70, 4.70, 5.56, 5.57, 5.56, 6.92, 6.92, 6.90, 6.82, 6.82, 6.82), 
                           DataQualityFlag = c("NF", "NF", "NF", "C", "C", "C", "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "NF", "I", "I", "I", NA, NA, NA, "NF", "NF", "NF", NA, NA, NA, NA, NA, NA), 
                           DataQualityFlagNote = c(NA, NA, NA, "DO probe failed calibration, not reading correctly", "DO probe failed calibration, not reading correctly", "DO probe failed calibration, not reading correctly", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "a lot of organic matter in spring", "a lot of organic matter in spring", "a lot of organic matter in spring", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), 
                           SpCondInstrument = c("YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 2", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1", "YSI Multimeter 1"), 
                           VisitType = c("Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Primary", "Replicate", "Replicate", "Replicate"), 
                           DPL = c("Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Provisional", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Provisional", "Provisional", "Provisional"), 
                           MonitoringStatus = c("Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled", "Sampled"))

dir <- "temp-test-csv"
dir.create(dir)
readr::write_csv(dummy.temp, file.path(dir, "WaterQualityTemperature.csv"))
readr::write_csv(dummy.spcond, file.path(dir, "WaterQualitySpCond.csv"))
readr::write_csv(dummy.ph, file.path(dir, "WaterQualitypH.csv"))
readr::write_csv(dummy.do, file.path(dir, "WaterQualityDO.csv"))

test_that("QcWqMedian works as expected", {
  expected <- tibble::tibble(Park = c("DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "MOJA", "JOTR", "DEVA", "DEVA", "DEVA"), 
                             FieldSeason = c("2019", "2019", "2019", "2020", "2019", "2019", "2020", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019"), 
                             SiteCode = c("DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR0004", "LAKE_P_SPR0005", "LAKE_P_SPR0005", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0012"),                             VisitDate = c("2018-11-20", "2018-11-20", "2018-11-21", "2019-11-19", "2018-11-14", "2018-11-15", "2019-11-07", "2019-04-09", "2019-04-10", "2020-04-07", "2020-03-02", "2020-01-29", "2019-02-12", "2019-02-13", "2019-02-14"), 
                             TempFlag = c("NF", "NF", "I", NA, "I", NA, "NF", NA, "NF", "NF", "NF", "NF", NA, "NF", NA), 
                             TempFlagNote = c(NA, NA, "had to break through ice", NA, "hot spring near river", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), 
                             TempMedian = c(17.1, 8.90, 3.13, 6.23, 51.3, 18.4, 18.8, 14.6, 9.42, 10.9, 14.2, 12.1, 19.4, 13.9, 9.75), 
                             SpCondFlag = c("NF", "NF", "NF", NA, "NF", NA, "NF", NA, "NF", "NF", "I", "NF", NA, "NF", NA), 
                             SpCondFlagNote = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "spring on salty playa", NA, NA, NA, NA), 
                             SpCondMedian = c(2342, 3863, NA, 976, 876, 3233, 3312, 1801, 320, 346, 51102, 782, 1320, 8643, 2676), 
                             pHFlag = c("NF", "I", "I", NA, "NF", NA, "NF", NA, "NF", "NF", "NF", "NF", NA, "W", NA), 
                             pHFlagNote = c(NA, "spring near mine tailings", "had to break through ice", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "error during pH calibration, probe did not stabilize, might be old", NA), 
                             pHMedian = c(7.90, 3.86, 7.35, 7.42, 7.06, 7.65, 7.71, 10.81, 7.24, 7.33, 7.10, 6.89, 8.18, 5.80, 7.96), 
                             DOFlag = c("NF", "C", "NF", NA, "NF", NA, "NF", NA, "NF", "NF", "NF", "I", NA, "NF", NA), 
                             DOFlagNote = c(NA, "DO probe failed calibration, not reading correctly", NA, NA, NA, NA, NA, NA, NA, NA, NA, "a lot of organic matter in spring", NA, NA, NA), 
                             DOPercentMedian = c(84.3, 139, NA, 88.8, 42.1, 172.4, 78.9, 90.7, 84.4, 82.5, 72.2, 29.3, 69.7, 85.6, 91.3), 
                             DOmgLMedian = c(5.75, 15.55, NA, 6.76, 2.33, 18.43, 5.05, 6.84, 5.46, 5.30, 4.96, 1.96, 4.70, 5.56, 6.92))
  result <- QcWqMedian(path.to.data = dir, data.source = "local")
  result_DEVA <- QcWqMedian(path.to.data = dir, data.source = "local", park = "DEVA")
  result_2019 <- QcWqMedian(path.to.data = dir, data.source = "local", field.season = "2019")
  expect_mapequal(result, expected)
  expect_mapequal(result_DEVA, dplyr::filter(expected, Park == "DEVA"))
  expect_mapequal(result_2019, dplyr::filter(expected, FieldSeason == "2019"))
})

test_that("QcWqSanity works as expected", {
  expected <- tibble::tibble(Park = c("LAKE", "MOJA", "DEVA", "PARA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE"),
                             FieldSeason = c("2019", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2019"),
                             SiteCode = c("LAKE_P_SPR0004", "MOJA_P_SPR0008", "DEVA_P_SPR0002", "PARA_P_SPR0006", "DEVA_P_SPR0011", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "LAKE_P_SPR0005", "LAKE_P_SPR0005"),
                             VisitDate = c("2018-11-14", "2020-03-02", "2018-11-20", "2019-04-09", "2019-02-13", "2018-11-20", "2018-11-20", "2018-11-15", "2018-11-15"),
                             Parameter = c("Temp", "SpCond", "pH", "pH", "pH", "DO", "DO", "DO", "DO"),
                             Units = c("C", "uS/cm", "units", "units", "units", "%", "mg/L", "%", "mg/L"),
                             Median = c(51.3, 51102, 3.86, 10.81, 5.80, 139, 15.55, 172.4, 18.43),
                             Flag = c("I", "I", "I", NA, "W", "C", "C", NA, NA),
                             FlagNote = c("hot spring near river", "spring on salty playa", "spring near mine tailings", NA, "error during pH calibration, probe did not stabilize, might be old", "DO probe failed calibration, not reading correctly", "DO probe failed calibration, not reading correctly", NA, NA))
  result <- QcWqSanity(path.to.data = dir, data.source = "local")
  result_DEVA <- QcWqSanity(path.to.data = dir, data.source = "local", park = "DEVA")
  result_2019 <- QcWqSanity(path.to.data = dir, data.source = "local", field.season = "2019")
  expect_mapequal(result, expected)
  expect_mapequal(result_DEVA, dplyr::filter(expected, Park == "DEVA"))
  expect_mapequal(result_2019, dplyr::filter(expected, FieldSeason == "2019"))
})

test_that("QcWqFlags works as expected", {
  expected <- tibble::tibble(Park = c("DEVA", "LAKE", "MOJA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "JOTR", "JOTR"),
                             FieldSeason = c("2019", "2019", "2020", "2019", "2019", "2019", "2019", "2019", "2020", "2020"),
                             SiteCode = c("DEVA_P_SPR0003", "LAKE_P_SPR0004", "MOJA_P_SPR0008", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0011", "DEVA_P_SPR0002", "DEVA_P_SPR0002", "JOTR_P_SPR0009", "JOTR_P_SPR0009"),
                             VisitDate = c("2018-11-21", "2018-11-14", "2020-03-02", "2018-11-20", "2018-11-21", "2019-02-13", "2018-11-20", "2018-11-20", "2020-01-29", "2020-01-29"),
                             Parameter = c("Temp", "Temp", "SpCond", "pH", "pH", "pH", "DO", "DO", "DO", "DO"),
                             Units = c("C", "C", "uS/cm", "units", "units", "units", "%", "mg/L", "%", "mg/L"),
                             Median = c(3.13, 51.3, 51102, 3.86, 7.35, 5.80, 139, 15.55, 29.3, 1.96),
                             Flag = c("I", "I", "I", "I", "I", "W", "C", "C", "I", "I"),
                             FlagNote = c("had to break through ice", "hot spring near river", "spring on salty playa", "spring near mine tailings", "had to break through ice", "error during pH calibration, probe did not stabilize, might be old", "DO probe failed calibration, not reading correctly", "DO probe failed calibration, not reading correctly", "a lot of organic matter in spring", "a lot of organic matter in spring"))
  result <- QcWqFlags(path.to.data = dir, data.source = "local")
  result_DEVA <- QcWqFlags(path.to.data = dir, data.source = "local", park = "DEVA")
  result_2019 <- QcWqFlags(path.to.data = dir, data.source = "local", field.season = "2019")
  expect_mapequal(result, expected)
  expect_mapequal(result_DEVA, dplyr::filter(expected, Park == "DEVA"))
  expect_mapequal(result_2019, dplyr::filter(expected, FieldSeason == "2019"))
})

test_that("QcWqCleaned works as expected", {
  expected <- tibble::tibble(Park = c("DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "MOJA", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "MOJA", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "LAKE", "PARA", "PARA", "PARA", "MOJA", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "PARA", "PARA", "PARA", "MOJA", "JOTR", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "DEVA", "LAKE", "LAKE", "PARA", "PARA", "PARA", "MOJA", "JOTR", "DEVA", "DEVA", "DEVA"), 
                             FieldSeason = c("2019", "2019", "2019", "2020", "2019", "2019", "2020", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2019", "2019", "2020", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2019", "2020", "2019", "2019", "2020", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2020", "2019", "2020", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019", "2019", "2019", "2020", "2019", "2020", "2019", "2019", "2020", "2020", "2020", "2019", "2019", "2019"), 
                             SiteCode = c("DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR0004", "LAKE_P_SPR0005", "LAKE_P_SPR0005", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR0004", "LAKE_P_SPR0005", "LAKE_P_SPR0005", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0001", "DEVA_P_SPR0002", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR0004", "LAKE_P_SPR0005", "LAKE_P_SPR0005", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0012", "DEVA_P_SPR0001", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR0004", "LAKE_P_SPR0005", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0012", "DEVA_P_SPR0001", "DEVA_P_SPR0003", "DEVA_P_SPR0003", "LAKE_P_SPR0004", "LAKE_P_SPR0005", "PARA_P_SPR0006", "PARA_P_SPR0007", "PARA_P_SPR0007", "MOJA_P_SPR0008", "JOTR_P_SPR0009", "DEVA_P_SPR0010", "DEVA_P_SPR0011", "DEVA_P_SPR0012"), 
                             VisitDate = c("2018-11-20", "2018-11-20", "2018-11-21", "2019-11-19", "2018-11-14", "2018-11-15", "2019-11-07", "2019-04-09", "2019-04-10", "2020-04-07", "2020-03-02", "2020-01-29", "2019-02-12", "2019-02-13", "2019-02-14", "2018-11-20", "2018-11-20", "2018-11-21", "2019-11-19", "2018-11-14", "2018-11-15", "2019-11-07", "2019-04-09", "2019-04-10", "2020-04-07", "2020-03-02", "2020-01-29", "2019-02-12", "2019-02-13", "2019-02-14", "2018-11-20", "2018-11-20", "2018-11-21", "2019-11-19", "2018-11-14", "2018-11-15", "2019-11-07", "2019-04-09", "2019-04-10", "2020-04-07", "2020-03-02", "2020-01-29", "2019-02-12",  "2019-02-14", "2018-11-20", "2018-11-21", "2019-11-19", "2018-11-14", "2019-11-07", "2019-04-09", "2019-04-10", "2020-04-07", "2020-03-02", "2020-01-29", "2019-02-12", "2019-02-13", "2019-02-14", "2018-11-20", "2018-11-21", "2019-11-19", "2018-11-14", "2019-11-07", "2019-04-09", "2019-04-10", "2020-04-07", "2020-03-02", "2020-01-29", "2019-02-12", "2019-02-13", "2019-02-14"), 
                             Parameter = c("Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO"), 
                             Units = c("C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "units", "units", "units", "units", "units", "units", "units", "units", "units", "units", "units", "units", "units", "units", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L"), 
                             Median = c(17.1, 8.90, 3.13, 6.23, 51.3, 18.4, 18.8, 14.6, 9.42, 10.9, 14.2, 12.1, 19.4, 13.9, 9.75, 2342, 3863, NA, 976, 876, 3233, 3312, 1801, 320, 346, 51102, 782, 1320, 8643, 2676, 7.90, 3.86, 7.35, 7.42, 7.06, 7.65, 7.71, 10.81, 7.24, 7.33, 7.10, 6.89, 8.18, 7.96, 84.3, NA, 88.8, 42.1, 78.9, 90.7, 84.4, 82.5, 72.2, 29.3, 69.7, 85.6, 91.3, 5.75, NA, 6.76, 2.33, 5.05, 6.84, 5.46, 5.30, 4.96, 1.96, 4.70, 5.56, 6.92))
  result <- QcWqCleaned(path.to.data = dir, data.source = "local")
  result_DEVA <- QcWqCleaned(path.to.data = dir, data.source = "local", park = "DEVA")
  result_2019 <- QcWqCleaned(path.to.data = dir, data.source = "local", field.season = "2019")
  expect_mapequal(result, expected)
  expect_mapequal(result_DEVA, dplyr::filter(expected, Park == "DEVA"))
  expect_mapequal(result_2019, dplyr::filter(expected, FieldSeason == "2019"))
})

test_that("QcWqStats works as expected", {
  expected <- tibble::tibble(Park = c("DEVA", "DEVA", "JOTR", "LAKE", "LAKE", "MOJA", "PARA", "PARA", "DEVA", "DEVA", "JOTR", "LAKE", "LAKE", "MOJA", "PARA", "PARA", "DEVA", "DEVA", "JOTR", "LAKE", "LAKE", "MOJA", "PARA", "PARA", "DEVA", "DEVA", "JOTR", "LAKE", "LAKE", "MOJA", "PARA", "PARA", "DEVA", "DEVA", "JOTR", "LAKE", "LAKE", "MOJA", "PARA", "PARA"),
                             FieldSeason = c("2019", "2020", "2020", "2019", "2020", "2020", "2019", "2020", "2019", "2020", "2020", "2019", "2020", "2020", "2019", "2020", "2019", "2020", "2020", "2019", "2020", "2020", "2019", "2020", "2019", "2020", "2020", "2019", "2020", "2020", "2019", "2020", "2019", "2020", "2020", "2019", "2020", "2020", "2019", "2020"),
                             Parameter = c("Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "Temp", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "SpCond", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "pH", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO", "DO"),
                             Units = c("C", "C", "C", "C", "C", "C", "C", "C", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "uS/cm", "units", "units", "units", "units", "units", "units", "units", "units", "%", "%", "%", "%", "%", "%", "%", "%", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L", "mg/L"),
                             `0%` = c(3.1, 6.2, 12.1, 18.4, 18.8, 14.2, 9.4, 10.9, 1320, 976, 782, 876, 3312, 51102, 320, 346, 3.86, 7.42, 6.89, 7.06, 7.71, 7.10, 7.24, 7.33, 69.7, 88.8, 29.3, 42.1, 78.9, 72.2, 84.4, 82.5, 4.70, 6.76, 1.96, 2.33, 5.05, 4.96, 5.46, 5.30),
                             `25%` = c(9.1, 6.2, 12.1, 26.6, 18.8, 14.2, 10.7, 10.9, 2342, 976, 782, 1465, 3312, 51102, 690, 346, 7.35, 7.42, 6.89, 7.21, 7.71, 7.10, 8.13, 7.33, 80.7, 88.8, 29.3, 42.1, 78.9, 72.2, 86.0, 82.5, 5.35, 6.76, 1.96, 2.33, 5.05, 4.96, 5.805, 5.30),
                             `50%` = c(11.8, 6.2, 12.1, 34.9, 18.8, 14.2, 12.0, 10.9, 2676, 976, 782, 2055, 3312, 51102, 1061, 346, 7.9, 7.42, 6.89, 7.36, 7.71, 7.10, 9.03, 7.33, 85.0, 88.8, 29.3, 42.1, 78.9, 72.2, 87.6, 82.5, 5.66, 6.76, 1.96, 2.33, 5.05, 4.96, 6.15, 5.30),
                             `75%` = c(16.3, 6.2, 12.1, 43.1, 18.8, 14.2, 13.3, 10.9, 3863, 976, 782, 2644, 3312, 51102, 1431, 346, 7.96, 7.42, 6.89, 7.50, 7.71, 7.10, 9.92, 7.33, 87.0, 88.8, 29.3, 42.1, 78.9, 72.2, 89.1, 82.5, 6.04, 6.76, 1.96, 2.33, 5.05, 4.96, 6.50, 5.30),
                             `100%` = c(19.4, 6.2, 12.1, 51.3, 18.8, 14.2, 14.6, 10.9, 8643, 976, 782, 3233, 3312, 51102, 1801, 346, 8.18, 7.42, 6.89, 7.65, 7.71, 7.10, 10.81, 7.33, 91.3, 88.8, 29.3, 42.1, 78.9, 72.2, 90.7, 82.5, 6.92, 6.76, 1.96, 2.33, 5.05, 4.96, 6.84, 5.30))
  result <- QcWqStats(path.to.data = dir, data.source = "local")
  result_DEVA <- QcWqStats(path.to.data = dir, data.source = "local", park = "DEVA")
  result_2019 <- QcWqStats(path.to.data = dir, data.source = "local", field.season = "2019")
  expect_mapequal(result, expected)
  expect_mapequal(result_DEVA, dplyr::filter(expected, Park == "DEVA"))
  expect_mapequal(result_2019, dplyr::filter(expected, FieldSeason == "2019"))
})